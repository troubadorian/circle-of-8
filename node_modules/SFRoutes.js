var url = require("url");
var DefaultExportable = {
	"/"            : DefaultRootViewController,
	"/user"        : DefaultUserViewController,
	"/favicon.ico" : DefaultFaviconViewController,
	"fallback"     : DefaultFallback
};

var sfconfig = require("../sfconfig.json")
var exportable = null;
var UserDefinedRoutes = require("../routes/" + sfconfig.UserDefinedRoutes);
var UserDefinedControllers = require("../controllers/" + sfconfig.UserDefinedControllers);

/*
 * Common Method Signature is function <Function Name> (request, response, query, hash) {...}
 * All methods should end() the responses, it is the programmer's responsibility
*/

function DefaultRootViewController (request, response, query, hash) {
	response.writeHead(200, {"Content-Type": "text/html"});
	response.write("<html><head></head><body><h1>Root Folder : Default Handler</h1></body></html>");
	response.end();
}


function DefaultUserViewController (request, response, query, hash) {
	response.writeHead(200, {"Content-Type": "application/json"});
	var str = "{\n"
		+	"'you'     : 'are', \n"
		+	"'viewing' : 'the', \n"
		+	"'default' : 'json',\n"
		+ "'response': 'here',\n"
		+	"'and'     : 'your',\n"
		+	"'query'   : 'was', \n"
		+ JSON.stringify(query)
	+ "\n }";
	response.write(str);
	response.end();
}

function DefaultFaviconViewController (request, response, query, hash) {
	response.writeHead(200, {"Content-Type": "image/png"});
	response.end();
}

function DefaultFallback (request, response, query, hash) {
	// if the Routes do not have the path to the service, we can check for the request
	// if the resource exists, then we add it to the Routes Object
	// else, 404 :P

	// Will write valid cases here in future {...}

	//Handling all 404 cases
	response.statusCode = 404;
	response.write('404 Page not found : Default Handler', 'utf8');
	response.end();
}

//There is an issue with hoisiting I guess
//Otherwise, I'd have defined the functions after the export statement
module.exports = exportable || DefaultExportable;